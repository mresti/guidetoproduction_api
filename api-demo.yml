---
host: api
become: true
gather_facts: yes
pre_tasks:
  - name: API | Building binary API
    local_action: shell go build api.go
    become: false 
tasks:
  - name: API | Create directory for API bin
    file:
      path: /api
      owner: root
      group: root
      mode: 0755
      state: directory

  - name: API | Stat API binary
    copy:
      src: api
      dest: /api/demo
      owner: root
      group: root
    mode: 0755

  - name: API | Run API demo
    command: "/api/demo &"
